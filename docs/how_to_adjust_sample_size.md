# å¦‚ä½•è°ƒæ•´æµ‹è¯•æ ·æœ¬æ•°

## ğŸ¯ å¿«é€Ÿä¿®æ”¹

é»˜è®¤é…ç½®ä¼šéšæœºæŠ½å– **2000 æ¡**æ ·æœ¬è¿›è¡Œè¯„ä¼°ã€‚

### æ–¹æ³• 1: ç›´æ¥ä¿®æ”¹è¯„ä¼°è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
vim configs/qrecc/compare_base_vs_trained_f1.sh
```

æ‰¾åˆ°è¿™ä¸€è¡Œï¼š
```bash
data.val_data_num=2000 \
```

ä¿®æ”¹ä¸ºä½ æƒ³è¦çš„æ•°é‡ï¼š
```bash
data.val_data_num=500     # å¿«é€Ÿæµ‹è¯• 500 æ¡
data.val_data_num=2000    # é»˜è®¤ 2000 æ¡ï¼ˆæ¨èï¼‰
data.val_data_num=5000    # æµ‹è¯• 5000 æ¡
data.val_data_num=null    # æµ‹è¯•å…¨éƒ¨ 16,451 æ¡
```

### æ–¹æ³• 2: å‘½ä»¤è¡Œä¸´æ—¶æŒ‡å®š

è¿è¡Œè¯„ä¼°æ—¶é€šè¿‡å‘½ä»¤è¡Œå‚æ•°è¦†ç›–ï¼š

```bash
# ä¸´æ—¶æµ‹è¯• 500 æ¡
bash configs/qrecc/compare_base_vs_trained_f1.sh \
    data.val_data_num=500

# æµ‹è¯•å…¨éƒ¨æ ·æœ¬
bash configs/qrecc/compare_base_vs_trained_f1.sh \
    data.val_data_num=null
```

## â±ï¸ æµ‹è¯•æ—¶é—´ä¼°ç®—

åŸºäº 4å¡ A800 æœåŠ¡å™¨ï¼Œå•ä¸ªæ¨¡å‹è¯„ä¼°æ—¶é—´ï¼š

| æ ·æœ¬æ•° | é¢„ä¼°æ—¶é—´ | æ¨èåœºæ™¯ |
|--------|---------|---------|
| **500** | 15-30 åˆ†é’Ÿ | å¿«é€ŸéªŒè¯é…ç½® |
| **2000** | 1-1.5 å°æ—¶ | æ—¥å¸¸è¯„ä¼°ï¼ˆæ¨èï¼‰ |
| **5000** | 2-3 å°æ—¶ | è¾ƒå®Œæ•´è¯„ä¼° |
| **16,451** (å…¨éƒ¨) | 5-8 å°æ—¶ | æœ€ç»ˆè®ºæ–‡/æŠ¥å‘Š |

**æ³¨æ„**:
- å¯¹æ¯”è¯„ä¼°ï¼ˆbase vs trainedï¼‰éœ€è¦è¿è¡Œä¸¤æ¬¡ï¼Œæ—¶é—´ç¿»å€
- è®­ç»ƒåçš„æ¨¡å‹å› ä¸ºè°ƒç”¨æ£€ç´¢ä¼šç¨æ…¢ä¸€äº›

## ğŸ“Š æ ·æœ¬éšæœºæ€§

veRL æ¡†æ¶ä¼šè‡ªåŠ¨è¿›è¡Œéšæœºé‡‡æ ·ï¼š

```python
# å†…éƒ¨å®ç°ï¼ˆæ— éœ€æ‰‹åŠ¨æ“ä½œï¼‰
if data.val_data_num is not None:
    dataset = dataset.sample(n=data.val_data_num, random_state=42)
```

- âœ… æ¯æ¬¡è¿è¡Œé‡‡æ ·ç›¸åŒï¼ˆrandom_state=42ï¼‰
- âœ… ç»“æœå¯å¤ç°
- âœ… æ ·æœ¬åˆ†å¸ƒå‡åŒ€

## ğŸ” éªŒè¯é‡‡æ ·æ•°é‡

è¿è¡Œè¯„ä¼°åï¼ŒæŸ¥çœ‹æ—¥å¿—ç¡®è®¤å®é™…æµ‹è¯•æ ·æœ¬æ•°ï¼š

```bash
grep "original dataset len" results/qrecc_comparison_*/base_model/eval.log
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
original dataset len: 16451
filter dataset len: 2000
```

## ğŸ’¡ æ¨èé…ç½®

### å¼€å‘é˜¶æ®µ
```bash
data.val_data_num=500   # å¿«é€Ÿè¿­ä»£
```

### æ—¥å¸¸è¯„ä¼°
```bash
data.val_data_num=2000  # å¹³è¡¡é€Ÿåº¦å’Œå‡†ç¡®æ€§ï¼ˆé»˜è®¤ï¼‰
```

### æœ€ç»ˆè¯„ä¼°
```bash
data.val_data_num=null  # å…¨é‡æµ‹è¯•
```

## ğŸ¯ å¿«é€Ÿåˆ‡æ¢

å¦‚æœç»å¸¸éœ€è¦åˆ‡æ¢æ ·æœ¬æ•°ï¼Œå¯ä»¥åœ¨è„šæœ¬å¼€å¤´æ·»åŠ é…ç½®å˜é‡ï¼š

```bash
# åœ¨ compare_base_vs_trained_f1.sh å¼€å¤´æ·»åŠ 
export VAL_SAMPLE_NUM=2000  # ä¿®æ”¹è¿™é‡Œå³å¯

# åœ¨è„šæœ¬ä¸­ä½¿ç”¨
data.val_data_num=$VAL_SAMPLE_NUM \
```

ç„¶åè¿è¡Œæ—¶ï¼š
```bash
export VAL_SAMPLE_NUM=500
bash configs/qrecc/compare_base_vs_trained_f1.sh
```

---

**å½“å‰é…ç½®**: é»˜è®¤ä½¿ç”¨ **2000 æ¡**éšæœºæ ·æœ¬
